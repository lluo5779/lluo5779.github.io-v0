if (self.CavalryLogger) { CavalryLogger.start_js(["pPXw7"]); }

__d("LoginFormKeys",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({BUTTON_KEY:"loginbutton",CUID:"cuid",EMAIL_FIELD_CONTAINER:"email_container",EMAIL_FIELD_KEY:"email",ERROR_BOX_KEY:"error_box",HEADER_BLOCK:"header_block",NOT_ME_LINK:"not_me_link",PASSWORD_FIELD_KEY:"pass",PREFILL_CONTACT_POINT:"prefill_contact_point",PREFILL_SOURCE:"prefill_source",PREFILL_TYPE:"prefill_type"})}),null);
__d('LoginAsyncRequestController',['cx','AsyncRequest','Button','ContextualDialog','CSS','DeferredCookie','DOM','ErrorContextualDialogXUITheme','Event','Form','LayerAutoFocus','LayerRefocusOnHide','LoginFormKeys','Keys','URI','ge'],(function a(b,c,d,e,f,g,h){var i="_4rer",j=20,k={init:function l(m,n){this.container=m;this.ajaxURI=new (c('URI'))(n);this.loginButton=c('ge')(c('LoginFormKeys').BUTTON_KEY);this.passwordInput=c('ge')(c('LoginFormKeys').PASSWORD_FIELD_KEY);var o=this.ajaxURI.getQueryData().try_number;this.tryNumber=parseInt(o!=null?o:1,10);this.hasSubmittedRequest=false;this.setUpEmailInput();if(this.loginButton!=null){c('DOM').setAttributes(this.loginButton,{type:'button'});c('Event').listen(this.loginButton,'click',this._onSubmitLoginRequest.bind(this))}if(this.passwordInput!=null)c('Event').listen(this.passwordInput,'keydown',this._onEnterSubmitLoginRequest.bind(this));},initNotmeLink:function l(m){this.notMeLink=c('ge')(c('LoginFormKeys').NOT_ME_LINK);this.notMeURI=m;if(this.notMeLink!=null){c('DOM').setAttributes(this.notMeLink,{href:'#'});c('Event').listen(this.notMeLink,'click',this._onClickNotmeLink.bind(this))}},setUpEmailInput:function l(){this.emailInput=c('ge')(c('LoginFormKeys').EMAIL_FIELD_KEY);if(this.emailInput!=null)c('Event').listen(this.emailInput,'keydown',this._onEnterSubmitLoginRequest.bind(this));},disableMultipleSubmit:function l(m){m.onsubmit=function(){c('Event').listen(document,'keydown',function(n){if(c('Event').getKeyCode(n)===c('Keys').RETURN)n.preventDefault();})}},_onClickNotmeLink:function l(){var m={},n=c('ge')(c('LoginFormKeys').CUID);if(n!=null)m.cuid=n.value;new (c('AsyncRequest'))().setURI(this.notMeURI).setMethod('POST').setData(m).setHandler(this._clearError.bind(this)).send()},_onEnterSubmitLoginRequest:function l(m){if(c('Event').getKeyCode(m)===c('Keys').RETURN){m.preventDefault();this._onSubmitLoginRequest()}},_onSubmitLoginRequest:function l(){c('DeferredCookie').flushAllCookies();if(this.hasSubmittedRequest===true)return;c('Button').setEnabled(this.loginButton,false);this._clearError();this.ajaxURI.addQueryData('try_number',this.tryNumber);var m=this._getFormData();this.hasSubmittedRequest=true;new (c('AsyncRequest'))().setURI(this.ajaxURI).setData(m).setMethod('POST').setHandler(this._onLoginResponse.bind(this)).setTimeoutHandler(j*1000,this._enableFormSubmit.bind(this)).setErrorHandler(this._enableFormSubmit.bind(this)).send()},_onLoginResponse:function l(m){this.tryNumber+=1;if(this.passwordInput!=null)this.passwordInput.value='';if(m.payload!=null&&!!m.payload.did_redirect===false)this._enableFormSubmit();},showPasswordSpecificErrorDialog:function l(m,n){if(n!=null)this.passwordInput=n;if(this.passwordInput==null)return;var o=this.passwordInput;this.passwordErrorDialog=this._getContextualDialog(o,m);this.passwordErrorDialog.show();o.focus();c('CSS').addClass(o,i);c('Event').listen(o,'blur',this._hidePasswordError.bind(this));c('Event').listen(o,'focus',this._showPasswordError.bind(this));c('Event').listen(o,'mouseover',this._showPasswordError.bind(this));c('Event').listen(o,'click',this._showPasswordError.bind(this))},showEmailSpecificErrorDialog:function l(m,n){if(n!=null)this.emailInput=n;if(this.emailInput==null)return;var o=this.emailInput;this.emailErrorDialog=this._getContextualDialog(o,m);c('CSS').addClass(this.emailErrorDialog,i);if(this.emailErrorDialog!=null)this.emailErrorDialog.show();o.value='';o.focus();c('CSS').addClass(o,i);c('Event').listen(o,'blur',this._hideEmailError.bind(this));c('Event').listen(o,'focus',this._showEmailError.bind(this));c('Event').listen(o,'mouseover',this._showEmailError.bind(this));c('Event').listen(o,'click',this._showEmailError.bind(this))},_getContextualDialog:function l(m,n){this._clearError();return new (c('ContextualDialog'))({context:m,position:'right',theme:c('ErrorContextualDialogXUITheme')},n).disableBehavior(c('LayerAutoFocus')).disableBehavior(c('LayerRefocusOnHide'))},_getFormData:function l(){var m={},n=c('Form').getInputs();n.forEach(function(o){m[o.id]=o.value});return m},_enableFormSubmit:function l(){c('Button').setEnabled(this.loginButton,true);this.hasSubmittedRequest=false},_clearError:function l(){if(this.emailErrorDialog!=null){this.emailErrorDialog.hide();this.emailErrorDialog=null}if(this.emailInput!=null)c('CSS').removeClass(this.emailInput,i);if(this.passwordErrorDialog!=null){this.passwordErrorDialog.hide();this.passwordErrorDialog=null}if(this.passwordInput!=null)c('CSS').removeClass(this.passwordInput,i);},_showEmailError:function l(){if(this.emailErrorDialog!=null)this.emailErrorDialog.show();},_showPasswordError:function l(){if(this.passwordErrorDialog!=null)this.passwordErrorDialog.show();},_hideEmailError:function l(){if(this.emailErrorDialog!=null)this.emailErrorDialog.hide();},_hidePasswordError:function l(){if(this.passwordErrorDialog!=null)this.passwordErrorDialog.hide();}};f.exports=k}),null);
__d('LoginFormError',['Event','containsNode','ContextualDialog','ErrorContextualDialogXUITheme','LayerAutoFocus','LayerRefocusOnHide'],(function a(b,c,d,e,f,g){'use strict';var h={setUpErrorContextualDialog:function i(j,k){var l=new (c('ContextualDialog'))({context:j,position:'right',theme:c('ErrorContextualDialogXUITheme')},k).disableBehavior(c('LayerAutoFocus')).disableBehavior(c('LayerRefocusOnHide'));l.show();this._setUpDialogEvents(j,l)},_setUpDialogEvents:function i(j,k){c('Event').listen(j,'blur',function(l){if(!c('containsNode')(k.getContentRoot(),l.relatedTarget))k.hide();});c('Event').listen(j,'focus',k.show.bind(k));c('Event').listen(j,'mouseover',k.show.bind(k));c('Event').listen(j,'click',k.show.bind(k))}};f.exports=h}),null);